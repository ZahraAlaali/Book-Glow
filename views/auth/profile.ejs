<head>
  <link rel="stylesheet" href="/stylesheets/profile.css" />
</head>

<%- include('../partials/_navbar.ejs') %>
<link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Cardo:ital,wght@0,400;0,700;1,400&family=Cinzel:wght@400..900&display=swap" rel="stylesheet">

<div class="profilePage">
  <header class="pageHeader">
    <h1>My Profile</h1>
  </header>

  <div class="profileLayout">
    <!-- LEFT: avatar preview + upload -->
    <aside class="card avatarCard">
      <img class="avatar" src="<%= user.profileImg %>" alt="profile image" />

      <form
        class="uploadForm"
        action="/auth/<%= user._id %>/profile"
        method="post"
        enctype="multipart/form-data"
      >
        <label class="fileLabel">
          <input type="file" name="profileImg" />
        </label>
        <button type="submit" class="btnPrimary">Upload New Photo</button>
      </form>
    </aside>

    <!-- RIGHT: details + password -->
    <main class="detailsStack">
      <!-- Account details -->
      <section class="card">
        <h2 class="cardTitle">Account Details</h2>

        <form
          class="profileForm"
          action="/auth/<%= user._id %>/profile?_method=PUT"
          method="post"
        >
          <div class="field">
            <label for="username">Username</label>
            <input
              id="username"
              type="text"
              name="username"
              value="<%= user.username %>"
              required
            />
          </div>

          <div class="field">
            <label for="email">Email</label>
            <input
              id="email"
              type="email"
              name="email"
              value="<%= user.email %>"
              required
            />
          </div>

          <div class="field">
            <label for="phone">Phone Number</label>
            <input
              id="phone"
              type="number"
              name="phone"
              value="<%= user.phone %>"
            />
          </div>

          <div class="actions">
            <button type="submit" class="btnPrimary">Update Profile</button>
          </div>
        </form>
      </section>

      <!-- Change password -->
      <section class="card">
        <h2 class="cardTitle">Change Password</h2>

        <form
          class="passwordForm"
          action="/auth/<%= user._id %>?_method=PUT"
          method="post"
        >
          <div class="field">
            <label for="oldPassword">Old Password</label>
            <input
              id="oldPassword"
              type="password"
              name="oldPassword"
              required
            />
          </div>

          <div class="field">
            <label for="newPassword">New Password</label>
            <input
              id="newPassword"
              type="password"
              name="newPassword"
              required
            />
          </div>

          <div class="field">
            <label for="confirmPassword">Confirm Password</label>
            <input
              id="confirmPassword"
              type="password"
              name="confirmPassword"
              required
            />
          </div>

          <div class="actions">
            <button type="submit" class="btnPrimary">Change Password</button>
          </div>
        </form>
      </section>
    </main>
  </div>
</div>
